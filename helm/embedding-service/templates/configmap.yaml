apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "embedding-service.fullname" . }}-config
  labels:
    {{- include "embedding-service.labels" . | nindent 4 }}
data:
  config.json: |
    {
      "service": {
        "host": {{ .Values.config.service.host | quote }},
        "port": {{ .Values.config.service.port }}
      },
      "embeddings": {
        "default_model": {{ .Values.config.embeddings.defaultModel | quote }},
        "allow_model_override": {{ .Values.config.embeddings.allowModelOverride }},
        "normalize_default": {{ .Values.config.embeddings.normalizeDefault }},
        "truncate_default": {{ .Values.config.embeddings.truncateDefault }},
        "batch_max_texts": {{ .Values.config.embeddings.batchMaxTexts }},
        "max_chars_per_text": {{ .Values.config.embeddings.maxCharsPerText }},
        "request_timeout_seconds": {{ .Values.config.embeddings.requestTimeoutSeconds }}
      },
      "observability": {
        "enabled": {{ .Values.config.observability.enabled }},
        "service_name": {{ .Values.config.observability.serviceName | quote }},
        "exporter": {{ .Values.config.observability.exporter | quote }},
        "otlp_endpoint": {{ .Values.config.observability.otlpEndpoint | quote }},
        "sampling_ratio": {{ .Values.config.observability.samplingRatio }}
      },
      "security": {
        "allowed_origins": {{ .Values.config.security.allowedOrigins | toJson }},
        "request_id_header": {{ .Values.config.security.requestIdHeader | quote }}
      }
    }
